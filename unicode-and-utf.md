# Unicode 与 UTF 的关系

## Unicode的由来
为了在计算机中表示我们平时写的字符（如数字0、1、2，字母a、b、c、A、B、C，标点符号，汉字等），需要对这些字符进行编码，即在计算机中用特定的数字表示这些字符。

最初，计算机在美国被使用时，由于英文的只有26个字母，算上大小写即其他符号，字符数也不多，于是只需要7个bit（可表示128个字符）就足够了。于是出现了最初的ASCII字符集，该字符集用0~127，共128个码位（Code Point，或称码点，即一个唯一的整数）来表示128个字符。在计算机中具体应用起来也比较简单，一个字符仅用一个字节即可表示，且只用到了一个字节的低7位，其最高位始终置为0。

後来，欧洲开始使用计算机，发现不同的字符数超过了128个（如法文、德文、俄文中的一些字符），只用7个bit无法表示完全。于是出现了ISO字符集，该集合中的字符数也没超过256个，所以在计算机中仅用1个字节表示即可表示完全。字节的最高位为1时，用来标识那些新增的欧洲国家文字中的字符；而最高位为0时，含义等同于ASCII字符集。

再後来，计算机在全世界普遍流行後，全世界文字的字符用1个字节（最多表示256个不同的字符）根本无法表示，尤其是像汉字这种含有几万十几万个不同字符的文字，另外还有一些科学上用到的符号、表情符号等。

为了统一世界范围内所有字符的编码，于是出现了Unicode（统一码）编码方案。Unicode由xx组织在1990年开始研发，1994年正式公布。Unicode字符集目前收录了xx个字符，分别用0~这些整数来表示。

Unicode表示一个字符时，通常以“U+”开头，後面跟着16进制的数字。如汉字“中”用Unicode表示为U+4E2D，其中16进制的4E2D的10进制值为20013，即20013这个码位在Unicode字符集中表示汉字“中”。

## UTF
Unicode只是一种将计算机中的数字与字符对应起来的编码方案，但是具体如何在计算机中使用这套编码方案（如用几个字节表示一个字符，每个字符所用字节数是否相同，若所用字节数不同则如何确定单个字符的字节边界等），还需要更为细致的实现方案。

UTF(Unicode Transformation Format，直译为Unicode转换格式) ，就是在计算机中使用Unicode表示字符的一套实施方案。

UTF有3套方案。

UTF-8是一种变长的编码规则，它根据每个字符的码位范围，将其用1到4个字节来表示。具体表示规则如下：
```
U+ 0000 ~ U+ 007F: 0XXXXXXX
U+ 0080 ~ U+ 07FF: 110XXXXX 10XXXXXX
U+ 0800 ~ U+ FFFF: 1110XXXX 10XXXXXX 10XXXXXX
U+10000 ~ U+1FFFF: 11110XXX 10XXXXXX 10XXXXXX 10XXXXXX
```
可以看出：
- 当字符的码值落在区间[0, 127]时，则只用1个字节表示即可。该字节最高位为0，低7位用来表示0~127这128个数值。

>> 如字母“a”的码位为U+0061（10进制值为97，2进制值为1100001），按UTF-8编码规则，在计算机中用 01100001（0x61） 这样1个字节表示。这其实就是ASCII字符集的范围。

- 当字符的码值落在区间[128, 2047]（共1920个值）时，则用2个字节表示。第1个字节的高3位固定为110，剩余5位可变；第2个字节的高2位固定为10，剩余6位可变。因此一共有5+6=11位可变，有2^11=2048个不同取值（多于1920个），因此用来一一映射到[128, 2047]这些数是没问题的。

>> 如乘号标记×，其Unicode码位为U+00D7（10进制值为215，2进制值为11010111）。转换成UTF-8编码时，将11010111的低6位单独取出，为010111，前面加上10前缀，成为10010111，即16进制的0x97；剩余的高2位（11）补足成5位（00011），再加上前缀110後为11000011，即16进制的0xC3。因此乘号×的UTF-8表示法为2个字节，高字节为0xC3，低字节为0x97。

- 当字符的码值落在区间[2048, 65535]（共63488个值）时，则用3个字节表示。第1个字节的高4位固定为1110，第2个字节的高2位固定为10，第3个字节的高2位固定为10。因此一共有4+6+6=16位可变，有2^16=65536个不同取值（多于63488个），因此用来一一映射[2048, 65535]这些数也不会有问题。

>> 如汉字“中”的Unicode码位为U+4E2D（10进制值为215，2进制值为1001110_00101101）（下划线_是为了阅读方便加上的）。转换成UTF-8编码时，先将低6位101101单独取出，加上10前缀後为10101101，即16进制的0xAD；再将中间6位111000取出，加上前缀10後为10111000，即16进制的0xB8；最後剩余3位100，补足成4位0100，再加上前缀1110後为11100100，即16进制的0xE4。因此汉字“中”在UTF-8编码规则中为3个字节，最高字节为0xE4，中间字节为0xB8，最低字节为0xAD。

---
#### 参考文档：
1. [utf-8和Unicode的区别](https://www.cnblogs.com/dhsz/p/7737480.html)
1. [Unicode 和 UTF-8 有什么区别？——知乎](https://www.zhihu.com/question/23374078)
